# -*- coding: utf-8 -*-
"""Bolus05cm&1cm_crossplane.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1JHmGaFM_8ac9sp_Zb-BBpMVt9LHslEm9
"""

import pandas as pd
import matplotlib.pyplot as plt
from io import StringIO
import numpy as np
from scipy.interpolate import interp1d

""" Data = cm, cGy """


""" profundidad en cm - datos - bolus 0.5 cm """

p0datos05 = """


-4.1583,0
-4.1224,0
-4.0866,0
-4.0508,0
-4.0149,0
-3.9791,0
-3.9433,0
-3.9074,0
-3.8716,0
-3.8358,0
-3.7999,0
-3.7641,0
-3.7283,0
-3.6924,0
-3.6566,0
-3.6208,0
-3.5849,0
-3.5491,63.7598
-3.5133,200.7918
-3.4774,226.2761
-3.4416,262.1962
-3.4058,291.956
-3.3699,315.3389
-3.3341,339.9216
-3.2983,365.9621
-3.2624,406.4664
-3.2266,433.1762
-3.1907,455.4227
-3.1549,475.2294
-3.1191,500.3805
-3.0832,518.5921
-3.0474,534.7893
-3.0116,550.4848
-2.9757,558.9502
-2.9399,565.9553
-2.9041,573.1088
-2.8682,577.3795
-2.8324,591.7259
-2.7966,598.4132
-2.7607,616.5379
-2.7249,623.0042
-2.6891,631.4563
-2.6532,644.505
-2.6174,649.8891
-2.5816,653.1478
-2.5457,658.2826
-2.5099,661.0084
-2.4741,668.0514
-2.4382,671.4654
-2.4024,678.3388
-2.3666,680.8373
-2.3307,683.2224
-2.2949,688.0702
-2.2591,690.0654
-2.2232,691.6508
-2.1874,697.9995
-2.1516,698.2408
-2.1157,698.2408
-2.0799,699.9394
-2.0441,701.6541
-2.0082,702.3933
-1.9724,707.8762
-1.9366,709.1331
-1.9007,710.3924
-1.8649,710.3924
-1.8291,711.9054
-1.7932,710.3924
-1.7574,713.167
-1.7216,709.1331
-1.6857,708.63
-1.6499,708.63
-1.6141,707.3742
-1.5782,709.8884
-1.5424,706.8728
-1.5066,706.8728
-1.4707,704.6247
-1.4349,704.8737
-1.3991,702.1466
-1.3632,704.6247
-1.3274,702.8875
-1.2915,700.4277
-1.2557,700.4277
-1.2199,705.622
-1.184,701.1626
-1.1482,701.9002
-1.1124,705.8719
-1.0765,706.372
-1.0407,709.6366
-1.0049,715.9405
-0.96904,715.9405
-0.93321,719.2053
-0.89738,719.2053
-0.86154,715.4367
-0.82571,714.4283
-0.78987,715.4367
-0.75404,715.9405
-0.71821,717.701
-0.68237,719.9554
-0.64654,719.4555
-0.6107,725.3948
-0.57487,725.1504
-0.53904,724.6607
-0.5032,726.3691
-0.46737,728.0605
-0.43153,727.0962
-0.3957,732.1112
-0.35987,736.8226
-0.32403,739.1635
-0.2882,740.0979
-0.25236,745.2283
-0.21653,747.7941
-0.1807,747.7941
-0.14486,747.7941
-0.10903,749.8973
-0.073195,751.3026
-0.037361,749.8973
-0.0015273,754.5949
0.034307,761.5039
0.070141,761.9861
0.10597,761.9861
0.14181,757.9124
0.17764,757.9124
0.21348,755.7764
0.24931,754.5949
0.28514,753.8875
0.32098,759.1049
0.35681,762.4692
0.39265,762.4692
0.42848,760.5419
0.46431,762.9533
0.50015,761.5039
0.53598,761.5039
0.57182,763.4382
0.60765,769.3373
0.64348,765.8774
0.67932,772.8567
0.71515,772.8567
0.75099,771.3406
0.78682,765.8774
0.82265,767.8476
0.85849,761.9861
0.89432,761.0225
0.93016,760.3019
0.96599,757.9124
1.0018,757.4366
1.0377,760.3019
1.0735,762.9533
1.1093,765.6324
1.1452,770.3364
1.181,774.3852
1.2168,776.4694
1.2527,777.5365
1.2885,779.7154
1.3243,781.9466
1.3602,781.9466
1.396,780.5464
1.4318,779.1655
1.4677,779.1655
1.5035,781.6651
1.5393,785.3723
1.5752,785.6613
1.611,786.8217
1.6468,790.0419
1.6827,794.1736
1.7185,794.7644
1.7543,793.2872
1.7902,791.5153
1.826,777.2683
1.8618,775.1586
1.8977,770.5869
1.9335,767.3534
1.9693,763.681
2.0052,763.1956
2.041,759.1049
2.0768,757.6744
2.1127,751.3026
2.1485,738.9297
2.1843,733.5298
2.2202,723.9239
2.256,718.7045
2.2918,717.4499
2.3277,709.6366
2.3635,702.1466
2.3993,692.5691
2.4352,688.5091
2.471,682.4185
2.5068,676.6567
2.5427,669.744
2.5785,661.8137
2.6144,648.7323
2.6502,637.4956
2.686,627.7542
2.7219,617.4628
2.7577,601.2525
2.7935,583.9387
2.8294,581.2265
2.8652,574.7147
2.901,561.6205
2.9369,548.1239
2.9727,540.8912
3.0085,529.2617
3.0444,518.5921
3.0802,503.2457
3.116,477.6993
3.1519,459.7428
3.1877,430.9425
3.2235,408.4282
3.2594,372.7406
3.2952,339.5759
3.331,305.9158
3.3669,259.5634
3.4027,0
3.4385,0
3.4744,0
3.5102,0
3.546,0
3.5819,0
3.6177,0
3.6535,0
3.6894,0
3.7252,0
3.761,0
3.7969,0
3.8327,0


"""


p1datos05 = """


-4.1037,0
-4.0678,0
-4.032,0
-3.9962,0
-3.9603,0
-3.9245,0
-3.8887,0
-3.8528,0
-3.817,0
-3.7812,0
-3.7453,0
-3.7095,0
-3.6737,0
-3.6378,0
-3.602,0
-3.5662,0
-3.5303,0
-3.4945,0
-3.4587,0
-3.4228,26.0645
-3.387,197.394
-3.3512,229.6469
-3.3153,270.2524
-3.2795,298.8006
-3.2437,325.8743
-3.2078,359.9305
-3.172,393.2456
-3.1362,418.7509
-3.1003,437.5927
-3.0645,461.6378
-3.0287,475.9772
-2.9928,500.2698
-2.957,516.9482
-2.9211,533.3916
-2.8853,544.3372
-2.8495,555.8033
-2.8136,562.1345
-2.7778,565.4376
-2.742,572.123
-2.7061,577.9337
-2.6703,586.04
-2.6345,592.1144
-2.5986,596.4808
-2.5628,601.4494
-2.527,618.8515
-2.4911,620.0083
-2.4553,633.1368
-2.4195,634.3662
-2.3836,642.2331
-2.3478,645.193
-2.312,650.382
-2.2761,653.7932
-2.2403,660.5262
-2.2045,665.7228
-2.1686,670.2572
-2.1328,678.528
-2.097,682.2189
-2.0611,684.243
-2.0253,685.9155
-1.9895,689.6177
-1.9536,693.4957
-1.9178,694.6652
-1.882,700.4277
-1.8461,700.9174
-1.8103,703.1349
-1.7745,703.6306
-1.7386,704.8737
-1.7028,705.8719
-1.667,711.6532
-1.6311,712.6624
-1.5953,719.2053
-1.5595,721.4504
-1.5236,722.195
-1.4878,719.2053
-1.452,717.4499
-1.4161,722.195
-1.3803,720.205
-1.3445,720.4545
-1.3086,725.8826
-1.2728,729.4964
-1.237,734.0016
-1.2011,737.994
-1.1653,739.8644
-1.1295,741.2649
-1.0936,741.9647
-1.0578,745.6946
-1.022,753.1813
-0.98612,756.25
-0.95028,760.5419
-0.91445,757.4366
-0.87861,760.0621
-0.84278,757.4366
-0.80695,757.4366
-0.77111,758.6274
-0.73528,757.199
-0.69944,757.199
-0.66361,758.866
-0.62778,761.0225
-0.59194,763.1956
-0.55611,763.681
-0.52028,768.5911
-0.48444,763.681
-0.44861,761.2631
-0.41277,761.2631
-0.37694,761.2631
-0.34111,762.4692
-0.30527,763.1956
-0.26944,766.8603
-0.2336,772.0971
-0.19777,770.3364
-0.16194,775.4186
-0.1261,771.3406
-0.090268,770.5869
-0.054434,769.8362
-0.0186,771.5924
0.017234,771.8446
0.053068,774.8997
0.088902,776.7347
0.12474,781.1043
0.16057,779.7154
0.1964,781.3844
0.23224,784.2213
0.26807,781.3844
0.30391,784.2213
0.33974,787.6962
0.37557,789.1603
0.41141,790.9255
0.44724,794.1736
0.48308,795.9452
0.51891,801.5062
0.55474,803.5198
0.59058,806.3462
0.62641,807.4569
0.66225,811.7591
0.69808,811.7591
0.73391,812.2789
0.76975,812.2789
0.80558,812.2789
0.84142,815.5423
0.87725,818.1287
0.91308,820.9459
0.94892,822.3482
0.98475,820.9459
1.0206,819.8953
1.0564,821.3545
1.0923,821.3545
1.1281,819.8953
1.1639,823.4903
1.1998,825.7922
1.2356,825.7922
1.2714,828.1924
1.3073,828.644
1.3431,831.19
1.3789,832.3772
1.4148,831.19
1.4506,833.0179
1.4864,834.3919
1.5223,834.0212
1.5581,832.2475
1.5939,832.5063
1.6298,831.591
1.6656,828.3439
1.7014,825.4525
1.7373,824.9333
1.7731,819.0248
1.8089,816.2647
1.8448,812.5371
1.8806,807.4569
1.9164,800.0539
1.9523,795.9452
1.9881,784.5083
2.0239,781.9466
2.0598,775.6797
2.0956,770.3364
2.1314,762.7111
2.1673,755.5398
2.2031,750.1314
2.2389,745.6946
2.2748,739.3972
2.3106,734.4728
2.3464,717.1986
2.3823,701.1626
2.4181,691.6508
2.4539,683.0206
2.4898,675.1916
2.5256,668.0514
2.5614,659.8843
2.5973,656.6824
2.6331,641.1643
2.6689,620.7017
2.7048,595.325
2.7406,586.3817
2.7764,579.5465
2.8123,571.4767
2.8481,564.1135
2.884,555.1698
2.9198,540.1684
2.9556,516.0741
2.9915,496.5963
3.0273,471.8603
3.0631,445.8999
3.099,420.5684
3.1348,386.5291
3.1706,346.8574
3.2065,311.6668
3.2423,282.2616
3.2781,223.0623
3.314,0
3.3498,0
3.3856,0
3.4215,0
3.4573,0
3.4931,0
3.529,0
3.5648,0
3.6006,0
3.6365,0
3.6723,0
3.7081,0
3.744,0
3.7798,0
3.8156,0
3.8515,0
3.8873,0


"""


p2datos05 = """


-3.9643,0
-3.9285,0
-3.8927,0
-3.8568,0
-3.821,0
-3.7852,0
-3.7493,0
-3.7135,0
-3.6777,0
-3.6418,0
-3.606,0
-3.5702,0
-3.5343,0
-3.4985,0
-3.4627,0
-3.4268,4.9029
-3.391,184.9533
-3.3552,201.4143
-3.3193,223.4873
-3.2835,254.2761
-3.2476,276.2936
-3.2118,295.3935
-3.176,309.9749
-3.1401,325.0433
-3.1043,346.5537
-3.0685,364.4779
-3.0326,383.6786
-2.9968,405.7781
-2.961,423.5566
-2.9251,437.7852
-2.8893,450.0411
-2.8535,458.1721
-2.8176,471.3418
-2.7818,479.8746
-2.746,490.0949
-2.7101,502.9167
-2.6743,506.5083
-2.6385,517.7146
-2.6026,522.6642
-2.5668,531.7684
-2.531,539.5456
-2.4951,543.5366
-2.4593,551.6169
-2.4235,553.2203
-2.3876,555.2494
-2.3518,558.1199
-2.316,560.8841
-2.2801,562.6478
-2.2443,563.8201
-2.2085,566.2521
-2.1726,568.2035
-2.1368,569.8954
-2.101,570.9179
-2.0651,570.9179
-2.0293,572.2043
-1.9935,573.2752
-1.9576,573.6097
-1.9218,573.5258
-1.886,573.7779
-1.8501,576.0258
-1.8143,576.3825
-1.7785,577.8408
-1.7426,580.725
-1.7068,582.2484
-1.671,584.4815
-1.6351,584.4815
-1.5993,584.4815
-1.5635,585.1423
-1.5276,585.365
-1.4918,585.1423
-1.456,585.1423
-1.4201,583.6164
-1.3843,583.6164
-1.3485,583.6164
-1.3126,583.6164
-1.2768,582.8741
-1.2409,582.6644
-1.2051,581.5303
-1.1693,580.2298
-1.1334,579.6434
-1.0976,579.1612
-1.0618,578.9699
-1.0259,577.6557
-0.99011,576.4721
-0.95428,576.4721
-0.91844,577.3795
-0.88261,578.0268
-0.84677,579.9355
-0.81094,579.6434
-0.77511,578.9699
-0.73927,577.8408
-0.70344,577.2878
-0.6676,577.1052
-0.63177,577.1052
-0.59594,577.1964
-0.5601,577.2878
-0.52427,578.59
-0.48844,578.59
-0.4526,581.4288
-0.41677,581.5303
-0.38093,582.7691
-0.3451,583.0848
-0.30927,585.0315
-0.27343,586.3817
-0.2376,587.0732
-0.20176,588.3706
-0.16593,587.1896
-0.1301,588.3706
-0.094262,588.1318
-0.058428,589.0949
-0.022594,589.8311
0.01324,589.8311
0.049074,589.8311
0.084908,590.7056
0.12074,590.7056
0.15658,590.7056
0.19241,590.7056
0.22824,589.5844
0.26408,589.5844
0.29991,589.5844
0.33575,589.955
0.37158,589.955
0.40741,590.3288
0.44325,592.9223
0.47908,592.9223
0.51492,593.49
0.55075,595.325
0.58658,595.325
0.62242,596.1445
0.65825,594.6921
0.69409,594.6921
0.72992,593.346
0.76575,593.6355
0.80159,595.649
0.83742,595.9781
0.87326,596.312
0.90909,598.7788
0.94492,600.0906
0.98076,600.0906
1.0166,601.2525
1.0524,601.2525
1.0883,601.2525
1.1241,599.335
1.1599,599.335
1.1958,599.1486
1.2316,598.232
1.2674,595.0059
1.3033,598.232
1.3391,602.0452
1.3749,602.8514
1.4108,603.4645
1.4466,603.4645
1.4824,603.877
1.5183,600.6674
1.5541,602.4466
1.5899,599.9002
1.6258,594.2312
1.6616,595.0059
1.6974,594.5371
1.7333,592.3778
1.7691,591.7259
1.8049,594.5371
1.8408,591.7259
1.8766,591.7259
1.9124,592.3778
1.9483,590.9586
1.9841,588.6107
2.0199,586.2675
2.0558,583.7235
2.0916,582.56
2.1274,578.1201
2.1633,576.562
2.1991,573.1919
2.2349,570.4436
2.2708,567.6737
2.3066,564.2602
2.3424,563.2339
2.3783,555.6456
2.4141,552.8874
2.4499,549.5025
2.4858,544.3372
2.5216,539.3373
2.5575,527.2885
2.5933,521.6724
2.6291,508.97
2.665,497.4896
2.7008,486.0664
2.7366,476.8361
2.7725,461.2719
2.8083,452.1719
2.8441,440.9807
2.88,430.5097
2.9158,419.5987
2.9516,405.3939
2.9875,393.2456
3.0233,368.838
3.0591,353.0568
3.095,333.4831
3.1308,315.5065
3.1666,298.8006
3.2025,279.89
3.2383,258.3277
3.2741,235.1023
3.31,207.2956
3.3458,0
3.3816,0
3.4175,0
3.4533,0
3.4891,0
3.525,0
3.5608,0
3.5966,0
3.6325,0
3.6683,0
3.7041,0
3.74,0
3.7758,0
3.8116,0
3.8475,0
3.8833,0
3.9191,0
3.955,0
3.9908,0
4.0266,0

"""



""" profundidad en cm - datos - bolus 1 cm """


p0datos1 = """


-3.9017,0
-3.8658,0
-3.83,0
-3.7942,0
-3.7583,0
-3.7225,0
-3.6867,0
-3.6508,0
-3.615,0
-3.5792,0
-3.5433,0
-3.5075,29.817
-3.4717,213.5091
-3.4358,258.7966
-3.4,291.99
-3.3642,322.2894
-3.3283,357.5924
-3.2925,393.082
-3.2567,420.1816
-3.2208,442.3173
-3.185,459.3894
-3.1492,489.6464
-3.1133,514.1157
-3.0775,530.0266
-3.0417,543.5366
-3.0058,554.1235
-2.97,566.1036
-2.9342,569.9734
-2.8983,575.8486
-2.8625,585.1423
-2.8267,587.3062
-2.7908,596.9942
-2.755,610.3724
-2.7192,618.62
-2.6833,624.8309
-2.6475,635.1698
-2.6116,646.5549
-2.5758,653.7932
-2.54,661.0084
-2.5041,665.7228
-2.4683,671.4654
-2.4325,675.3733
-2.3966,682.8193
-2.3608,685.2827
-2.325,686.5546
-2.2891,687.4166
-2.2533,693.962
-2.2175,699.2093
-2.1816,702.1466
-2.1458,703.1349
-2.11,707.3742
-2.0741,712.9147
-2.0383,712.9147
-2.0025,712.41
-1.9666,715.1847
-1.9308,715.6887
-1.895,716.9472
-1.8591,717.9521
-1.8233,722.195
-1.7875,726.3691
-1.7516,729.0188
-1.7158,737.994
-1.68,743.5967
-1.6441,744.0628
-1.6083,744.529
-1.5725,747.3273
-1.5366,745.6946
-1.5008,744.9952
-1.465,746.161
-1.4291,748.2611
-1.3933,749.6634
-1.3575,752.711
-1.3216,752.711
-1.2858,752.711
-1.25,754.1232
-1.2141,754.1232
-1.1783,756.0131
-1.1425,756.487
-1.1066,763.681
-1.0708,764.4109
-1.035,766.8603
-0.99912,766.8603
-0.96329,766.8603
-0.92745,763.1956
-0.89162,768.0952
-0.85579,770.3364
-0.81995,771.8446
-0.78412,771.8446
-0.74828,771.8446
-0.71245,771.8446
-0.67662,769.8362
-0.64078,770.3364
-0.60495,774.1295
-0.56911,776.2051
-0.53328,781.9466
-0.49745,782.2287
-0.46161,783.079
-0.42578,782.795
-0.38994,783.079
-0.35411,785.9508
-0.31828,786.531
-0.28244,782.795
-0.24661,789.4539
-0.21077,790.0419
-0.17494,789.7478
-0.13911,790.0419
-0.10327,789.7478
-0.067438,791.8104
-0.031604,790.3363
0.0042295,790.3363
0.040063,786.2407
0.075897,786.2407
0.11173,781.6651
0.14757,779.1655
0.1834,769.8362
0.21923,769.8362
0.25507,775.6797
0.2909,776.2051
0.32674,776.2051
0.36257,781.1043
0.3984,783.9349
0.43424,783.9349
0.47007,784.7958
0.5059,787.1128
0.54174,789.1603
0.57757,789.1603
0.61341,788.2809
0.64924,783.3637
0.68507,776.2051
0.72091,779.7154
0.75674,784.2213
0.79258,789.4539
0.82841,795.0597
0.86424,797.1238
0.90008,798.0057
0.93591,799.178
0.97175,799.178
1.0076,801.5062
1.0434,802.6599
1.0792,802.6599
1.1151,805.5053
1.1509,808.5546
1.1867,805.5053
1.2226,803.8053
1.2584,801.5062
1.2943,799.4703
1.3301,799.4703
1.3659,801.5062
1.4018,806.625
1.4376,806.0666
1.4734,802.6599
1.5093,806.0666
1.5451,802.084
1.5809,798.5924
1.6168,798.5924
1.6526,797.712
1.6884,791.8104
1.7243,786.8217
1.7601,785.9508
1.7959,785.0838
1.8318,781.9466
1.8676,774.1295
1.9034,767.8476
1.9393,766.8603
1.9751,764.4109
2.0109,756.487
2.0468,754.5949
2.0826,749.4295
2.1184,739.6308
2.1543,735.1789
2.1901,730.2115
2.2259,725.8826
2.2618,723.4312
2.2976,716.9472
2.3334,715.6887
2.3693,714.1761
2.4051,711.1487
2.4409,698.2408
2.4768,696.7993
2.5126,691.6508
2.5484,685.2827
2.5843,678.3388
2.6201,673.3969
2.6559,666.5495
2.6918,658.2826
2.7276,648.0666
2.7634,617.9256
2.7993,604.5015
2.8351,592.1144
2.8709,580.1315
2.9068,570.0515
2.9426,557.2034
2.9784,545.8197
3.0143,526.1893
3.0501,506.0764
3.0859,494.2455
3.1218,473.2187
3.1576,449.6677
3.1935,430.0771
3.2293,414.6621
3.2651,385.0605
3.301,360.3226
3.3368,338.2038
3.3726,314.3825
3.4085,294.5065
3.4443,268.5004
3.4801,231.9136
3.516,122.3148
3.5518,0
3.5876,0
3.6235,0
3.6593,0
3.6951,0
3.731,0
3.7668,0
3.8026,0
3.8385,0
3.8743,0
3.9101,0
3.946,0
3.9818,0
4.0176,0
4.0535,0
4.0893,0


"""



p1datos1 = """


-3.8294,0
-3.7936,0
-3.7578,0
-3.7219,0
-3.6861,0
-3.6503,0
-3.6144,0
-3.5786,0
-3.5428,0
-3.5069,2.1371
-3.4711,221.1844
-3.4353,258.4982
-3.3994,280.3615
-3.3636,309.3935
-3.3278,336.2333
-3.2919,370.2881
-3.2561,395.612
-3.2203,422.1663
-3.1844,440.5837
-3.1486,464.5488
-3.1128,477.0515
-3.0769,498.9378
-3.0411,511.2055
-3.0053,525.4189
-2.9694,532.2023
-2.9336,545.9176
-2.8978,553.3858
-2.8619,557.8919
-2.8261,562.1345
-2.7903,563.527
-2.7544,570.365
-2.7186,578.6847
-2.6828,583.4029
-2.6469,588.2511
-2.6111,596.4808
-2.5752,602.4466
-2.5394,616.076
-2.5036,623.0042
-2.4677,627.5318
-2.4319,634.7697
-2.3961,636.155
-2.3602,638.9837
-2.3244,642.2331
-2.2886,646.5549
-2.2527,651.6887
-2.2169,653.4707
-2.1811,652.0139
-2.1452,654.7586
-2.1094,656.2021
-2.0736,661.3303
-2.0377,662.9455
-2.0019,665.065
-1.9661,666.7155
-1.9302,666.7155
-1.8944,666.7155
-1.8586,670.0858
-1.8227,670.2572
-1.7869,670.9457
-1.7511,671.1186
-1.7152,671.1186
-1.6794,671.1186
-1.6436,677.0273
-1.6077,679.0986
-1.5719,678.9079
-1.5361,681.2293
-1.5002,689.3947
-1.4644,697.9995
-1.4286,709.8884
-1.3927,710.6444
-1.3569,709.8884
-1.3211,711.1487
-1.2852,714.1761
-1.2494,713.9239
-1.2136,714.6805
-1.1777,715.1847
-1.1419,716.9472
-1.1061,717.4499
-1.0702,717.9521
-1.0344,723.4312
-0.99855,725.8826
-0.96272,725.8826
-0.92689,732.8211
-0.89105,734.4728
-0.85522,739.1635
-0.81939,739.1635
-0.78355,741.0316
-0.74772,739.6308
-0.71188,740.3314
-0.67605,739.3972
-0.64022,739.3972
-0.60438,740.0979
-0.56855,740.0979
-0.53271,739.1635
-0.49688,739.3972
-0.46105,740.5648
-0.42521,743.1304
-0.38938,745.9278
-0.35354,752.9461
-0.31771,753.4166
-0.28188,754.1232
-0.24604,757.4366
-0.21021,757.4366
-0.17437,757.199
-0.13854,757.199
-0.10271,752.2411
-0.066872,753.1813
-0.031038,756.7242
0.0047958,754.5949
0.04063,756.7242
0.076464,757.4366
0.1123,759.1049
0.14813,759.1049
0.18397,759.1049
0.2198,762.4692
0.25563,761.9861
0.29147,760.7821
0.3273,762.4692
0.36314,762.9533
0.39897,770.0861
0.4348,774.3852
0.47064,777.001
0.50647,777.8057
0.54231,781.9466
0.57814,783.079
0.61397,781.9466
0.64981,777.8057
0.68564,781.1043
0.72147,780.2686
0.75731,772.8567
0.79314,782.2287
0.82898,787.1128
0.86481,787.4043
0.90064,789.4539
0.93648,791.5153
0.97231,808.0074
1.0081,808.0074
1.044,806.9031
1.0798,808.0074
1.1156,808.0074
1.1515,806.9031
1.1873,808.0074
1.2232,809.9069
1.259,809.9069
1.2948,809.9069
1.3307,809.9069
1.3665,811.4976
1.4023,808.2815
1.4382,805.7863
1.474,798.8854
1.5098,795.6501
1.5457,792.9917
1.5815,791.5153
1.6173,793.2872
1.6532,787.4043
1.689,791.8104
1.7248,790.3363
1.7607,789.4539
1.7965,785.3723
1.8323,783.3637
1.8682,778.8917
1.904,775.1586
1.9398,771.8446
1.9757,771.8446
2.0115,771.8446
2.0473,770.5869
2.0832,770.3364
2.119,770.3364
2.1548,768.0952
2.1907,767.1067
2.2265,765.6324
2.2623,762.7111
2.2982,760.5419
2.334,759.8225
2.3698,756.7242
2.4057,751.5371
2.4415,750.3654
2.4773,746.8607
2.5132,739.8644
2.549,727.82
2.5848,719.2053
2.6207,713.6716
2.6565,704.3758
2.6923,683.2224
2.7282,675.1916
2.764,648.3999
2.7998,632.7209
2.8357,613.5467
2.8715,594.0802
2.9073,574.7147
2.9432,563.6002
2.979,553.2203
3.0148,541.1997
3.0507,509.3942
3.0865,486.4012
3.1223,459.0384
3.1582,439.7293
3.194,414.1796
3.2299,390.1326
3.2657,350.5492
3.3015,327.6686
3.3374,303.4311
3.3732,289.9501
3.409,255.3416
3.4449,0
3.4807,0
3.5165,0
3.5524,0
3.5882,0
3.624,0
3.6599,0
3.6957,0
3.7315,0
3.7674,0
3.8032,0
3.839,0
3.8749,0
3.9107,0
3.9465,0
3.9824,0
4.0182,0
4.054,0
4.0899,0
4.1257,0
4.1615,0
4.1974,0



"""





p2datos1 = """


-4.0789,0
-4.043,0
-4.0072,0
-3.9714,0
-3.9355,0
-3.8997,0
-3.8639,0
-3.828,0
-3.7922,0
-3.7564,0
-3.7205,0
-3.6847,0
-3.6489,0
-3.613,0
-3.5772,0
-3.5414,0
-3.5055,37.8134
-3.4697,155.9386
-3.4339,159.8916
-3.398,173.0076
-3.3622,182.7136
-3.3264,198.7172
-3.2905,212.7662
-3.2547,227.8219
-3.2189,243.3744
-3.183,257.3893
-3.1472,268.5414
-3.1114,278.6458
-3.0755,285.1075
-3.0397,293.8595
-3.0039,297.2792
-2.968,303.359
-2.9322,305.5094
-2.8963,312.8298
-2.8605,315.7167
-2.8247,320.9144
-2.7888,326.5665
-2.753,329.5087
-2.7172,335.677
-2.6813,337.1296
-2.6455,340.384
-2.6097,340.9645
-2.5738,342.3103
-2.538,345.285
-2.5022,347.2227
-2.4663,348.7541
-2.4305,350.7983
-2.3947,352.7414
-2.3588,354.833
-2.323,355.9194
-2.2872,358.4987
-2.2513,361.24
-2.2155,361.5685
-2.1797,362.8207
-2.1438,365.621
-2.108,365.689
-2.0722,365.689
-2.0363,366.9984
-2.0005,367.4181
-1.9647,367.4181
-1.9288,367.5587
-1.893,370.2881
-1.8572,371.0976
-1.8213,371.5426
-1.7855,371.766
-1.7497,371.99
-1.7138,372.2895
-1.678,372.59
-1.6422,372.6653
-1.6063,371.0976
-1.5705,370.876
-1.5347,369.9958
-1.4988,369.1978
-1.463,367.9115
-1.4272,367.348
-1.3913,365.1471
-1.3555,363.8138
-1.3197,364.611
-1.2838,364.1456
-1.248,363.2837
-1.2122,364.1456
-1.1763,364.1456
-1.1405,362.6886
-1.1047,362.4246
-1.0688,362.4246
-1.033,361.24
-0.99715,360.6498
-0.96132,360.6498
-0.92548,360.4534
-0.88965,360.5844
-0.85381,361.8974
-0.81798,363.0852
-0.78215,363.8801
-0.74631,364.8783
-0.71048,365.2146
-0.67464,365.2146
-0.63881,365.8937
-0.60298,366.0306
-0.56714,367.0681
-0.53131,368.1952
-0.49548,368.5516
-0.45964,365.2146
-0.42381,365.2146
-0.38797,366.2366
-0.35214,366.3054
-0.31631,366.3054
-0.28047,366.3054
-0.24464,365.9621
-0.2088,365.2146
-0.17297,365.0125
-0.13714,365.4852
-0.1013,366.3054
-0.065468,368.2663
-0.029634,369.0537
0.0062002,369.3422
0.042034,369.3422
0.077868,369.3422
0.1137,369.27
0.14954,370.5815
0.18537,369.27
0.2212,369.27
0.25704,368.6946
0.29287,370.2881
0.32871,370.2881
0.36454,370.655
0.40037,370.508
0.43621,369.1257
0.47204,368.9098
0.50788,368.3375
0.54371,368.1952
0.57954,367.2079
0.61538,367.0681
0.65121,366.7202
0.68705,365.2146
0.72288,364.7445
0.75871,363.8801
0.79455,361.0431
0.83038,360.5844
0.86622,359.9958
0.90205,360.5844
0.93788,360.6498
0.97372,360.9775
1.0096,361.9632
1.0454,362.5566
1.0812,363.5486
1.1171,363.5486
1.1529,364.2785
1.1887,364.8114
1.2246,367.0681
1.2604,365.9621
1.2962,364.2785
1.3321,367.348
1.3679,365.9621
1.4037,365.8254
1.4396,365.8254
1.4754,366.7896
1.5112,366.2366
1.5471,366.5816
1.5829,366.5816
1.6187,366.5816
1.6546,366.7202
1.6904,366.7202
1.7262,365.8937
1.7621,365.1471
1.7979,363.6148
1.8337,363.2175
1.8696,362.4246
1.9054,360.2572
1.9412,360.1265
1.9771,359.0834
2.0129,355.9835
2.0487,355.2796
2.0846,354.3238
2.1204,352.1123
2.1562,351.2352
2.1921,350.4248
2.2279,349.1238
2.2637,346.5537
2.2996,344.6848
2.3354,341.6063
2.3712,338.8307
2.4071,335.677
2.4429,333.4289
2.4787,331.8711
2.5146,327.9721
2.5504,326.2195
2.5862,325.3842
2.6221,324.4631
2.6579,322.6616
2.6937,318.7268
2.7296,317.5503
2.7654,316.1812
2.8012,310.1697
2.8371,308.1291
2.8729,302.1761
2.9088,297.7619
2.9446,294.6087
2.9804,292.8734
3.0163,287.8331
3.0521,282.1193
3.0879,272.614
3.1238,265.5193
3.1596,253.0847
3.1954,238.4005
3.2313,222.8364
3.2671,210.1004
3.3029,193.7079
3.3388,176.4684
3.3746,14.2199
3.4104,0
3.4463,0
3.4821,0
3.5179,0
3.5538,0
3.5896,0
3.6254,0
3.6613,0
3.6971,0
3.7329,0
3.7688,0
3.8046,0
3.8404,0
3.8763,0
3.9121,0



"""

# Usamos StringIO para simular un archivo CSV a partir de las cadenas de datos
data_05p0 = pd.read_csv(StringIO(p0datos05), header=None, names=["posicion", "dosis"])
data_05p1 = pd.read_csv(StringIO(p1datos05), header=None, names=["posicion", "dosis"])
data_05p2 = pd.read_csv(StringIO(p2datos05), header=None, names=["posicion", "dosis"])
data_1p0 = pd.read_csv(StringIO(p0datos1), header=None, names=["posicion", "dosis"])
data_1p1 = pd.read_csv(StringIO(p1datos1), header=None, names=["posicion", "dosis"])
data_1p2 = pd.read_csv(StringIO(p2datos1), header=None, names=["posicion", "dosis"])

plt.figure(figsize=(10, 6))

# Curvas con b = 0.5 cm (usamos líneas continuas)
plt.plot(data_05p0['posicion'], data_05p0['dosis'], label='p = 0 cm b = 0.5 cm', linestyle='-', marker='o')
plt.plot(data_05p1['posicion'], data_05p1['dosis'], label='p = 1 cm b = 0.5 cm', linestyle='-', marker='o')
plt.plot(data_05p2['posicion'], data_05p2['dosis'], label='p = 2 cm b = 0.5 cm', linestyle='-', marker='o')

# Curvas con b = 1 cm (usamos líneas punteadas)
plt.plot(data_1p0['posicion'], data_1p0['dosis'], label='p = 0 cm b = 1 cm', linestyle='--', marker='x')
plt.plot(data_1p1['posicion'], data_1p1['dosis'], label='p = 1 cm b = 1 cm', linestyle='--', marker='x')
plt.plot(data_1p2['posicion'], data_1p2['dosis'], label='p = 2 cm b = 1 cm', linestyle='--', marker='x')

plt.xlabel('Distancia fuera del eje [cm]')
plt.ylabel('Dosis [cGy]')
plt.title('9 MeV, aplicador 10 cm, 0°')
plt.grid(True)
plt.legend()
plt.show()

import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
from scipy.interpolate import interp1d

# Función corregida para calcular FWHM
def calcular_fwhm(posicion, dosis):
    max_dosis = max(dosis)
    half_max_dosis = max_dosis / 2

    posiciones_half_max = np.where(dosis >= half_max_dosis)[0]

    if len(posiciones_half_max) > 1:
        fwhm_start = posicion[posiciones_half_max[0]]  # Primera posición donde se alcanza el 50%
        fwhm_end = posicion[posiciones_half_max[-1]]  # Última posición donde se alcanza el 50%
        fwhm = abs(fwhm_end - fwhm_start)
        return fwhm, fwhm_start, fwhm_end
    else:
        return None, None, None

# Función corregida para calcular la simetría y planitud
def calcular_simetria_planitud(posicion, dosis):
    indice_central = np.argmin(np.abs(posicion))  # Encuentra el índice más cercano a 0 (eje central)
    dosis_central = dosis[indice_central]

    izquierda = dosis[:indice_central]
    derecha = dosis[indice_central+1:][::-1]  # Invertir la parte derecha para comparar con la izquierda

    if len(izquierda) > len(derecha):
        izquierda = izquierda[:len(derecha)]
    elif len(derecha) > len(izquierda):
        derecha = derecha[:len(izquierda)]

    simetria = np.mean(np.abs(izquierda - derecha) / dosis_central) * 100  # Error relativo porcentual

    # Planitud: Variación dentro del área entre el 80% y 100% de la dosis máxima
    max_dosis = max(dosis)
    limite_inferior = 0.8 * max_dosis

    # Filtrar la región de interés (dosis >= 80% de la dosis máxima)
    indices_region = np.where(dosis >= limite_inferior)[0]

    if len(indices_region) > 0:
        dosis_region = dosis[indices_region]
        max_region = max(dosis_region)
        min_region = min(dosis_region)
        planitud = (max_region - min_region) / (max_region + min_region) * 100
    else:
        planitud = None

    return simetria, planitud

# Datos de dos conjuntos de características b = 0.5 cm y b = 1 cm
profundidades_05 = [data_05p0, data_05p1, data_05p2]
profundidades_1 = [data_1p0, data_1p1, data_1p2]

etiquetas_05 = ['p = 0 cm b = 0.5 cm', 'p = 1 cm b = 0.5 cm', 'p = 2 cm b = 0.5 cm']
etiquetas_1 = ['p = 0 cm b = 1 cm', 'p = 1 cm b = 1 cm', 'p = 2 cm b = 1 cm']

# Crear una lista para almacenar los resultados
resultados = []

# Realizar el análisis para cada perfil de b = 0.5 cm
for i, data in enumerate(profundidades_05):
    posicion = data['posicion'].values
    dosis = data['dosis'].values

    # Calcular FWHM
    fwhm, _, _ = calcular_fwhm(posicion, dosis)

    # Calcular simetría y planitud
    simetria, planitud = calcular_simetria_planitud(posicion, dosis)

    # Agregar los resultados a la lista
    resultados.append({
        'Característica': etiquetas_05[i],
        'FWHM (cm)': fwhm if fwhm is not None else 'N/A',
        'Simetría (%)': simetria if simetria is not None else 'N/A',
        'Planitud (%)': planitud if planitud is not None else 'N/A'
    })

# Realizar el análisis para cada perfil de b = 1 cm
for i, data in enumerate(profundidades_1):
    posicion = data['posicion'].values
    dosis = data['dosis'].values

    # Calcular FWHM
    fwhm, _, _ = calcular_fwhm(posicion, dosis)

    # Calcular simetría y planitud
    simetria, planitud = calcular_simetria_planitud(posicion, dosis)

    # Agregar los resultados a la lista
    resultados.append({
        'Característica': etiquetas_1[i],
        'FWHM (cm)': fwhm if fwhm is not None else 'N/A',
        'Simetría (%)': simetria if simetria is not None else 'N/A',
        'Planitud (%)': planitud if planitud is not None else 'N/A'
    })

# Convertir los resultados a un DataFrame de pandas para generar la tabla
df_resultados = pd.DataFrame(resultados)

# Mostrar la tabla
print(df_resultados)

# Opcional: Guardar la tabla en un archivo Excel o CSV
df_resultados.to_csv('resumen_analisis_radiacion.csv', index=False)
# df_resultados.to_excel('resumen_analisis_radiacion.xlsx', index=False)